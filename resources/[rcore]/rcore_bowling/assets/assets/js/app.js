(function(t){function e(e){for(var a,n,i=e[0],l=e[1],u=e[2],c=0,m=[];c<i.length;c++)n=i[c],Object.prototype.hasOwnProperty.call(o,n)&&o[n]&&m.push(o[n][0]),o[n]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);d&&d(e);while(m.length)m.shift()();return r.push.apply(r,u||[]),s()}function s(){for(var t,e=0;e<r.length;e++){for(var s=r[e],a=!0,i=1;i<s.length;i++){var l=s[i];0!==o[l]&&(a=!1)}a&&(r.splice(e--,1),t=n(n.s=s[0]))}return t}var a={},o={app:0},r=[];function n(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=a,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(s,a,function(e){return t[e]}.bind(null,a));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/assets/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=e,i=i.slice();for(var u=0;u<i.length;u++)e(i[u]);var d=l;r.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"119b":function(t,e,s){},"1a60":function(t,e,s){},2149:function(t,e,s){"use strict";s("cf75")},"38ae":function(t,e,s){"use strict";s("119b")},4386:function(t,e,s){"use strict";s("ef50")},"56d7":function(t,e,s){"use strict";s.r(e);var a=s("2b0e"),o=function(){var t=this,e=t._self._c;return e("div",{class:{"app-closed":!t.isShown,"app-visible":t.isShown},attrs:{id:"app"}},[e("scoreboard")],1)},r=[],n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"scoreboard"},[e("table",[e("img",{staticClass:"img-black-icon",attrs:{src:s("619a")}}),e("img",{staticClass:"img-blue-icon",attrs:{src:s("6d3e")}}),e("img",{staticClass:"img-orange-icon",attrs:{src:s("a8ef")}}),e("img",{staticClass:"img-purple-icon",attrs:{src:s("c106")}}),e("img",{staticClass:"img-red-icon",attrs:{src:s("696f")}}),e("tr",[e("th",{staticStyle:{"border-right":"0",width:"28px"}}),e("th",{staticStyle:{"border-left":"0",padding:"0 10px","min-width":"100px"}},[t._v(t._s(t.isTeamplay?t.translations.TEAM:t.translations.PLAYER))]),t.editMode?t._e():t._l(t.roundCount,(function(s){return e("th",{key:s,class:{"score-column":!0,"first-column":1==s,"last-column":s==t.roundCount}},[t._v(" "+t._s(s)+" ")])})),t.editMode?t._e():e("th",{staticClass:"score-column column-total"},[t._v(t._s(t.translations.TOTAL))])],2),t.editMode?t._e():t._l(t.bowlingState,(function(t,s){return e("scoreboard-line",{key:t.Name,attrs:{name:t.Name,score:t.Throws,id:s}})})),t.editMode?[t.allowBets?e("scoreboard-wager"):t._e(),e("scoreboard-rounds"),t._l(t.bowlingState,(function(s){return e("scoreboard-line-input",{key:s.Name,attrs:{name:s.Name,"server-id":s.ServerId,"is-registered":t.isRegistered,players:s.Players}})})),t.isRegistered?t._e():e("scoreboard-line-input",{attrs:{"is-teamplay":t.isTeamplay}}),e("scoreboard-line-control")]:t._e()],2),t.secondsTillClose?e("div",{staticClass:"result"},[t.wagerAccumulated&&t.wagerAccumulated>0?[t._v(" "+t._s(t.translations.MATCH_WHO_WON.format(t.winnerName,t.wagerAccumulated))),e("br"),t._v(t._s(t.translations.MATCH_END.format(t.secondsTillClose))+" ")]:t._e(),t.wagerAccumulated&&0!=t.wagerAccumulated?t._e():[t._v(" "+t._s(t.translations.MATCH_END.format(t.secondsTillClose))+" ")]],2):t._e()])},i=[],l=function(){var t=this,e=t._self._c;return e("tr",[e("td",{staticClass:"player-id"},[t._v(t._s(t.id+1))]),e("td",{staticClass:"player-name"},[t.currentTurnName==t.name?e("span",{staticClass:"current-turn"},[t._v(">")]):t._e(),t._v(" "+t._s(t.name))]),t._l(t.computedScore,(function(s,a){return e("td",{key:a+"_"+(s[0]?s[0]:"-1")+"_"+(s[1]?s[1]:"-1")+(s[2]?s[2]:"-1"),class:{"score-column":!0,"first-column":0==a,"last-column":a==t.roundCountIndex}},[e("div",{staticClass:"windows"},[a==t.roundCountIndex?[e("div",{staticClass:"window"},[t._v(" "+t._s(t.finalThrowFormat(s,2))+" ")]),e("div",{staticClass:"window"},[t._v(" "+t._s(t.finalThrowFormat(s,1))+" ")]),e("div",{staticClass:"window"},[t._v(" "+t._s(t.finalThrowFormat(s,0))+" ")])]:[e("div",{staticClass:"window"},[t._v(" "+t._s(t.formatSecondThrow(s))+" ")]),e("div",{staticClass:"window"},[t._v(" "+t._s(t.formatFirstThrow(s))+" ")])],e("div",{staticStyle:{clear:"both"}})],2),e("span",{staticClass:"round-score"},[t._v(" "+t._s(void 0!==s[3]?s[3]:"")+" ")])])})),e("td",{staticClass:"score-column column-total"},[t._v(" "+t._s(t.computedScore[t.roundCountIndex]&&void 0!==t.computedScore[t.roundCountIndex][3]?t.computedScore[t.roundCountIndex][3]:"")+" ")])],2)},u=[],d={props:["name","score","id"],methods:{formatFirstThrow(t){return void 0===t[0]||10==t[0]?"":t[0]},formatSecondThrow(t){return void 0===t[0]||null===t[0]?"":void 0===t[1]||null===t[1]?10==t[0]?"x":"":t[0]+t[1]==10?"/":t[1]},finalThrowFormat(t,e){return void 0===t[e]?"":1==e&&t[e]+t[e-1]==10?"/":10==t[e]?"x":t[e]}},computed:{currentTurnName(){return this.$store.state.currentTurnName},computedScore(){let t=this.score;for(let e=0;e<this.$store.state.roundCount;e++)t[e]||t.push([]);return t},roundCountIndex(){return this.$store.state.roundCount-1}}},c=d,m=(s("4386"),s("2877")),h=Object(m["a"])(c,l,u,!1,null,"06caafc3",null),p=h.exports,g=function(){var t=this,e=t._self._c;return e("tr",[e("td",{staticClass:"player-id"}),t.name?e("td",{staticClass:"player-name"},[!t.isRegistered&&t.isTeamGame?e("button",{staticClass:"join-team",on:{click:function(e){return t.joinTeam(t.name)}}},[t._v(t._s(t.translations.JOIN))]):t._e(),t._v(" "+t._s(t.name)+" "),t.serverId?[t._v(" #"+t._s(t.serverId)+" "),t.isOwner&&t.serverId!=t.ownerServerId?e("button",{staticClass:"remove-player",on:{click:function(e){return t.removePlayer(t.serverId)}}},[t._v("x")]):t._e()]:t._e(),t.players?e("span",{staticStyle:{"font-size":"80%"}},[t._v(" ("),t._l(t.players,(function(s,a){return e("span",{key:s},[t._v("#"+t._s(s)),a!=t.players.length-1?e("span",[t._v(", ")]):t._e(),t.isOwner&&s!=t.ownerServerId?e("button",{staticClass:"remove-player",on:{click:function(e){return t.removePlayer(s)}}},[t._v("x")]):t._e()])})),t._v(") ")],2):t._e()],2):t._e(),t.name?t._e():e("td",{staticClass:"player-name"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.inputName,expression:"inputName"}],attrs:{placeholder:t.isTeamplay?t.translations.TEAM_NAME:t.translations.YOUR_NAME},domProps:{value:t.inputName},on:{input:function(e){e.target.composing||(t.inputName=e.target.value)}}}),e("button",{attrs:{disabled:t.isDisabled},on:{click:t.register}},[t._v(t._s(t.translations.REGISTER))])])])},f=[],w=s("1157"),_=s("2f62");a["a"].use(_["a"]);var v=new _["a"].Store({state:{isTeamMode:!1,isOwner:!1,serverId:null,editMode:!0,totalRounds:5,isShown:!1,timeleft:null,wagerEnabled:!1,wagerAmount:null,wagerAmountCommited:null,wagerAccumulated:null,currentTurnName:null,roundCount:10,hideStart:!1,allowBets:!0,translations:{TOTAL:"Total",MATCH_END:"Match ends in {0} seconds",MATCH_WHO_WON:"{0} won ${1}",START:"Start",CLOSE:"Close",JOIN:"Join",REGISTER:"Register",WAGER:"Wager",WAGER_SET_TO:"Wager is set to <b>${0}</b>"},bowlingState:[]},mutations:{setAllowBets(t,e){a["a"].set(t,"allowBets",e)},setHideStart(t,e){a["a"].set(t,"hideStart",e)},increaseRoundCount(t){a["a"].set(t,"roundCount",t.roundCount+1)},decreaseRoundCount(t){a["a"].set(t,"roundCount",t.roundCount-1)},setRoundCount(t,e){a["a"].set(t,"roundCount",e)},setTranslations(t,e){a["a"].set(t,"translations",e)},setTimeleft(t,e){a["a"].set(t,"timeleft",e)},setCurrentTurnName(t,e){a["a"].set(t,"currentTurnName",e)},setWagerEnabled(t,e){a["a"].set(t,"wagerEnabled",e)},setWagerAmount(t,e){a["a"].set(t,"wagerAmount",e)},setWagerAmountCommited(t,e){a["a"].set(t,"wagerAmountCommited",e)},setWagerAccumulated(t,e){a["a"].set(t,"wagerAccumulated",e)},setModePlayers(t){a["a"].set(t,"isTeamMode",!1)},setModeTeams(t){a["a"].set(t,"isTeamMode",!0)},setIsOwner(t,e){a["a"].set(t,"isOwner",e)},setServerId(t,e){a["a"].set(t,"serverId",e)},naiveAddPlayer(t,e){t.bowlingState.push({Name:e,ServerId:t.serverId,Throws:[]})},updateState(t,e){a["a"].set(t,"bowlingState",e)},removePlayer(t,e){a["a"].set(t,"bowlingState",t.bowlingState.filter(t=>t.ServerId!=e))},setEditMode(t,e){a["a"].set(t,"editMode",e)},showBowling(t){a["a"].set(t,"isShown",!0)},hideBowling(t){a["a"].set(t,"isShown",!1)}},actions:{},modules:{}});function b(){v.commit("hideBowling"),w["post"]("https://rcore_bowling/close")}function C(t){w["post"]("https://rcore_bowling/register",JSON.stringify({name:t,isTeamGame:v.state.isTeamMode,wager:v.state.wagerEnabled?v.state.wagerAmount:null,roundCount:v.state.roundCount}))}function y(){setTimeout((function(){v.commit("hideBowling")}),1500),w["post"]("https://rcore_bowling/start")}function S(t){w["post"]("https://rcore_bowling/removePlayer",JSON.stringify({serverId:t}))}var T={props:["name","isTeamplay","serverId","players","isRegistered"],data(){return{inputName:""}},computed:{translations(){return this.$store.state.translations},isDisabled(){for(let t of this.$store.state.bowlingState)if(t.name==this.inputName)return!0;return 0==this.inputName.trim().length},ownerServerId(){return this.$store.state.serverId},isOwner(){return this.$store.state.isOwner},isTeamGame(){return this.$store.state.isTeamMode}},methods:{register(){this.inputName.trim().length>0&&(this.$store.commit("naiveAddPlayer",this.inputName),C(this.inputName))},joinTeam(t){C(t)},removePlayer(t){this.$store.commit("removePlayer",t),S(t)}}},$=T,A=(s("66bf"),Object(m["a"])($,g,f,!1,null,"58175cd2",null)),O=A.exports,M=function(){var t=this,e=t._self._c;return t.hideStart?t._e():e("tr",[e("td",{staticClass:"player-id"}),e("td",{staticClass:"player-name"},[t.isOwner&&t.canStart?e("button",{on:{click:t.start}},[t._v(t._s(t.translations.START))]):t._e(),t.isOwner&&!t.canStart?e("button",{attrs:{disabled:""}},[t._v(t._s(t.translations.START))]):t._e(),e("button",{on:{click:t.close}},[t._v(t._s(t.translations.CLOSE))])])])},E=[],I={props:[],methods:{close(){b()},start(){this.$store.commit("setEditMode",!1),y()}},computed:{hideStart(){return this.$store.state.hideStart},translations(){return this.$store.state.translations},canStart:function(){return this.$store.state.bowlingState.length>0},isOwner:function(){return this.$store.state.isOwner}}},x=I,N=(s("57b9"),Object(m["a"])(x,M,E,!1,null,"38f1edfe",null)),P=N.exports,R=function(){var t=this,e=t._self._c;return t.wagerAmountCommited||t.canSetWager?e("tr",[e("td",{staticClass:"player-id"}),e("td",{staticClass:"player-name"},[t.wagerAmountCommited?t._e():e("div",{staticClass:"wager-left"},[e("label",{staticClass:"custom-checkbox"},[e("input",{attrs:{type:"checkbox"},on:{input:t.wagerEnabledChange}}),e("span"),e("div",{staticClass:"wager-label"},[t._v(t._s(t.translations.WAGER))])])]),t.wagerAmountCommited?t._e():e("div",{staticClass:"wager-right",style:{visibility:t.wagerEnabled?"visible":"hidden"}},[t._v(" $"),e("input",{staticClass:"wager-amount",attrs:{type:"number"},domProps:{value:t.wagerAmount},on:{input:t.wagerAmountChange}})]),t.wagerAmountCommited?e("div",{staticClass:"wager-center"},[e("span",{domProps:{innerHTML:t._s(t.translations.WAGER_SET_TO.format(t.wagerAmountCommited))}})]):t._e()])]):t._e()},W=[],k={computed:{translations(){return this.$store.state.translations},canSetWager(){return 0==this.$store.state.bowlingState.length},wagerEnabled(){return this.$store.state.wagerEnabled},wagerAmount(){return this.$store.state.wagerAmount},wagerAmountCommited(){return this.$store.state.wagerAmountCommited}},methods:{wagerEnabledChange(t){this.$store.commit("setWagerEnabled",t.target.checked),t.target.checked||this.$store.commit("setWagerAmount",null)},wagerAmountChange(t){this.$store.commit("setWagerAmount",t.target.value)}}},j=k,B=(s("976f"),Object(m["a"])(j,R,W,!1,null,"7e431cca",null)),H=B.exports,G=function(){var t=this,e=t._self._c;return e("tr",[e("td",{staticClass:"player-id"}),e("td",{staticClass:"player-name"},[e("span",{staticClass:"round-count-label"},[t._v(t._s(t.translations.ROUND_COUNT))]),t.canChangeRoundCount?e("span",{staticClass:"round-change",on:{click:t.decrease}},[t._v("-")]):t._e(),e("span",{staticClass:"round-number"},[t._v(t._s(t.roundCount))]),t.canChangeRoundCount?e("span",{staticClass:"round-change",on:{click:t.increase}},[t._v("+")]):t._e()])])},L=[],D={computed:{translations(){return this.$store.state.translations},roundCount(){return this.$store.state.roundCount},canChangeRoundCount(){return 0==this.$store.state.bowlingState.length}},methods:{decrease(){this.$store.state.roundCount>3&&this.$store.commit("decreaseRoundCount")},increase(){this.$store.state.roundCount<10&&this.$store.commit("increaseRoundCount")}}},F=D,J=(s("2149"),Object(m["a"])(F,G,L,!1,null,"09bd588b",null)),z=J.exports,U={components:{ScoreboardLine:p,ScoreboardLineInput:O,ScoreboardLineControl:P,ScoreboardWager:H,ScoreboardRounds:z},computed:{allowBets(){return this.$store.state.allowBets},translations(){return this.$store.state.translations},winnerName(){let t=-1,e="";for(let s of this.$store.state.bowlingState){let a=s.Throws[s.Throws.length-1][3];a>t&&(t=a,e=s.Name)}return e},wagerAccumulated(){return this.$store.state.wagerAccumulated},secondsTillClose(){return this.$store.state.timeleft},isTeamplay(){return this.$store.state.isTeamMode},editMode(){return this.$store.state.editMode},bowlingState(){return this.$store.state.bowlingState},isRegistered(){for(let t of this.$store.state.bowlingState)if(t.ServerId){if(t.ServerId==this.$store.state.serverId)return!0}else for(let e of t.Players)if(e==this.$store.state.serverId)return!0;return!1},roundCount(){return this.$store.state.roundCount}}},Y=U,q=(s("38ae"),Object(m["a"])(Y,n,i,!1,null,null,null)),K=q.exports,Q=s("1e5c");function V(t){return t[Math.floor(Math.random()*Math.floor(t.length))]}String.prototype.format=function(){var t=arguments;return this.replace(/{(\d+)}/g,(function(e,s){return"undefined"!=typeof t[s]?t[s]:e}))};var X={name:"App",components:{Scoreboard:K},computed:{isShown(){return this.$store.state.isShown}},data(){return{audioPlayer:null,rollSounds:{}}},mounted(){window.addEventListener("message",this.onEvent),w(window).on("keyup",(function(t){113!=t.which&&27!=t.which||(t.preventDefault(),b())})),this.audioPlayer=new Q["Howl"]({src:["/assets/bowling.ogg"],sprite:{small_1:[0,609],small_2:[1222,628],small_3:[2241,792],small_4:[3582,578],small_5:[4814,732],small_6:[6268,930],big_1:[7666,567],big_2:[8314,509],big_3:[8907,535],roll:[9612,562,!0],reset_lowered:[10218,611],wipe_pins:[10867,1122]}}),this.audioPlayer.pannerAttr({coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,maxDistance:1e4,panningModel:"HRTF",refDistance:.8,rolloffFactor:.5,distanceModel:"linear"})},beforeDestroy(){window.removeEventListener("message",this.onEvent)},methods:{countdownTimeleft(t){(!this.$store.state.timeleft||t<30)&&(this.$store.commit("setTimeleft",t),t>1?setTimeout(()=>{this.countdownTimeleft(t-1)},1e3):b())},onEvent(t){if("setupPlayers"==t.data.type)t.data.isTeamGame?this.$store.commit("setModeTeams"):this.$store.commit("setModePlayers"),this.$store.commit("updateState",t.data.data),this.$store.commit("setTranslations",t.data.translations),"playing"==t.data.gameState?this.$store.commit("setEditMode",!1):"finished"==t.data.gameState?this.countdownTimeleft(30):this.$store.commit("setEditMode",!0),this.$store.commit("setHideStart",!1),this.$store.commit("setAllowBets",t.data.allowBets),this.$store.commit("setRoundCount",t.data.roundCount),this.$store.commit("setTimeleft",null),this.$store.commit("setWagerEnabled",!1),this.$store.commit("setWagerAmount",null),this.$store.commit("setWagerAmountCommited",t.data.wager),this.$store.commit("setServerId",t.data.serverId),this.$store.commit("setIsOwner",!0),this.show();else if("update"==t.data.type)this.$store.commit("setHideStart",t.data.hideStart||!1),this.$store.commit("setRoundCount",t.data.roundCount),this.$store.commit("updateState",t.data.data),this.$store.commit("setWagerAmountCommited",t.data.wager),this.$store.commit("setWagerAccumulated",t.data.wagerAccumulated),this.$store.commit("setCurrentTurnName",t.data.currentTurnName),"playing"==t.data.gameState?(this.$store.state.editMode&&setTimeout(()=>{b()},2e3),this.$store.commit("setEditMode",!1)):"finished"==t.data.gameState?this.countdownTimeleft(30):this.$store.commit("setEditMode",!0);else if("openJoin"==t.data.type)t.data.isTeamGame?this.$store.commit("setModeTeams"):this.$store.commit("setModePlayers"),"playing"==t.data.gameState?this.$store.commit("setEditMode",!1):"finished"==t.data.gameState?this.countdownTimeleft(30):this.$store.commit("setEditMode",!0),this.$store.commit("setHideStart",!1),this.$store.commit("setAllowBets",t.data.allowBets),this.$store.commit("setRoundCount",t.data.roundCount),this.$store.commit("setTranslations",t.data.translations),this.$store.commit("setTimeleft",null),this.$store.commit("setWagerAmountCommited",t.data.wager),this.$store.commit("setServerId",t.data.serverId),this.$store.commit("updateState",t.data.data),this.$store.commit("setIsOwner",!1),this.show();else if("showui"==t.data.type)this.show();else if("hideui"==t.data.type)this.hide();else if("unsetplayers"==t.data.type)this.$store.commit("updateState",[]);else if("playSound"==t.data.type){var e=this.audioPlayer.play(V(t.data.sounds));this.audioPlayer.pos(t.data.position.x,t.data.position.y,t.data.position.z,e),this.audioPlayer.volume(t.data.volume,e)}else if("setOrientation"==t.data.type)Q["Howler"].orientation(t.data.fwd.x,t.data.fwd.y,t.data.fwd.z,t.data.up.x,t.data.up.y,t.data.up.z),Q["Howler"].pos(t.data.coord.x,t.data.coord.y,t.data.coord.z);else if("playSoundBall"==t.data.type){var s=this.audioPlayer.play(V(t.data.sounds));this.audioPlayer.pos(t.data.position.x,t.data.position.y,t.data.position.z,s),this.audioPlayer.volume(t.data.volume,s),this.rollSounds[t.data.throwId]=s}else"stopSoundBall"==t.data.type&&this.audioPlayer.stop(this.rollSounds[t.data.throwId])},show(){this.$store.commit("showBowling")},hide(){this.$store.commit("hideBowling")}}},Z=X,tt=(s("5808"),Object(m["a"])(Z,o,r,!1,null,null,null)),et=tt.exports;a["a"].config.productionTip=!1,new a["a"]({store:v,render:t=>t(et)}).$mount("#app")},"57b9":function(t,e,s){"use strict";s("a01e")},5808:function(t,e,s){"use strict";s("b0a5")},"619a":function(t,e,s){t.exports=s.p+"assets/img/iconblack.png"},"66bf":function(t,e,s){"use strict";s("1a60")},"696f":function(t,e,s){t.exports=s.p+"assets/img/iconred.png"},"6d3e":function(t,e,s){t.exports=s.p+"assets/img/iconblue.png"},"71f5":function(t,e,s){},"976f":function(t,e,s){"use strict";s("71f5")},a01e:function(t,e,s){},a8ef:function(t,e,s){t.exports=s.p+"assets/img/iconorange.png"},b0a5:function(t,e,s){},c106:function(t,e,s){t.exports=s.p+"assets/img/iconpurple.png"},cf75:function(t,e,s){},ef50:function(t,e,s){}});